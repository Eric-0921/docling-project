## 5. 远程编程

## 5.1 OE1022D 命令语法

上位机与 OE1022D 的通信使用 ASCII 字符来进行。命令符使用大写，所有命令均由四个 命令字符（如有必要可带上参数）和一个命令终结符组成。当使用 RS232 转 USB 接口通信 时，终结字符必须是一个换行符 &lt;lf&gt; 或回车符 &lt;cr&gt; 。 OE1022D 只有在收到命令终结符时，才 会执行用户输入的命令。命令可能需要一个或多个参数，多个参数之间用逗号分隔 (,) 。

多个命令可以在同一命令行发送，但命令之间需要添加分号 (;) 。在同一行发送多个命令 和分别发送几个独立命令的区别在于：当一个命令行被解析和执行时，在整个命令行执行完 成之前， OE1022D 无法执行其他命令。

OE1022D 有一个容量为 256 个字符的输入缓存区，并根据接收命令的顺序来处理命令。 当缓存区写满时，最新命令将会把最旧并已执行命令覆盖。建议输入多个命令时不要超过 256 个字符。

OE1022D 允许用户通过命令查询内部参数的当前值。 查询命令的格式为由当前命令后加 上一个问号 '?' 并省略原命令所需的一个或多个参数。 OE1022D 以 ASCII 字符串的形式返回用 户所查询的参数，如果一个命令行中发送多个查询 ( 用分号隔开 ) 的话，应答将会一个一个地 返回，每个都对应一个终结符。

另外为了保证兼容性， OE1022D 仍然支持 OE1022 的通讯指令，但只能返回 A 通道的测 量数据。如果要返回 B 通道测量数据，必须使用本章介绍的命令。

命令格式举例：

| FMODD 1,1 <cr>    | 设置通道A的参考源为内部参考       |
|-------------------|----------------------|
| FREQD 1,10E3 <cr> | 设置通道A的内部参考信号频率为10kHz |
| OUTPD? 2,1 <cr>   | 查询通道B的通道1的输出值        |

<!-- image -->

## 5.2 详细的命令列表

每一个命令所指定的参数是有严格顺序的，不同参数之间用逗号 (,) 分隔。在大括号 { } 里 面的参数是可选的，不需要每个都填写。只有在命令后面加上 (?) 的助记符时，才会启动查 询命令，没有 (?) 是不会查询的。注意：在发送命令时 () 和 {} 都不需要发送。

变量定义如下：

| i,j,k,l,m,n   | 整数   |
|---------------|------|
| x             | 实数   |
| f             | 频率值  |

以上所有的数值变量均可以被表示为整数、浮点数或指数格式（例如，数字 5 可以表示 为 5 , 5.0 , .5E1 ） 。而字符串则被作为一个 ASCII 字符序列的形式发送。

其中i用于指定通道 A（CH-A）或通道 B(CH-A)，i=1 代表通道 A，i=2 代表通道 B。

<!-- image -->

## 5.2.1 参考与相位指令

| PHASD   | (?)   | i{,x}   | PHASD指令用于设置或查询参考相移。参数i 是指定通道A/B，参数x是指相位值（实数值，单 位：°） 。用PHASDi,x命令可以设置通道A（i=1） 或B（i=2）的相移值为x。 x的值会被四舍五入到0.01°。相位限制在± 180°。例如，发送PHASD 1,-179.0这条指令会设 置OE1022D 通道A的相移值为-179.00°。而指令 PHASD? 1则是发送查询通道A的参考相移指令。   |
|---------|-------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| FMODD   | (?)   | i{,j}   | FMODD指令用于设置或查询参考信号源。参数 i是指定通道A/B，参数j=0时选择外部参考，j=1 时选择内部参考，j=2时选择内部扫频参考。                                                                                                                                     |
| FREQD   | (?)   | i{,f}   | FREQD指令用于设置或查询内部参考信号的频 率。参数i是指定通道A/B，参数f是指频率值（单 位：Hz） 。指令FREQD? 1会返回通道A当前的参考 信号频率（内部或外部） 。                                                                                                                  |
| RSLPD   | (?)   | i{,j}   | 当使用外部参考源时，RSLPD指令用于设置或 查询参考信号当前的触发方式。 参数i是指定通道A/B，参数j=0时设置TTL 上升沿触发；参数j=1时设置TTL下降沿触发；参 数j=2时设置正弦波过零检测。 当频率低于1Hz时， 必须使用TTL触发方式。                                                                              |
| SWTPD   | (?)   | i{,j}   | SWTPD指令用于设置或查询内部扫频模式，参 数i是指定通道A/B， 参数j=0时选择Linear模式， j=1时选择Log模式。                                                                                                                                           |
| SLLMD   | (?)   | i{,f}   | SLLMD指令用于设置或查询内部扫频模式下的 Start开始频率。参数i是指定通道A/B，参数f 是指定Start频率（单位：Hz） 。指令SLLMD? 1会 返回通道A内部扫频模式的Start开始频率。f值 可设置范围0-102KHz，最小分辨率为1mHz。                                                                          |
| SULMD   | (?)   | i{,f}   | SULMD指令用于设置或查询内部扫频模式下 Stop截止频率。参数i是指定通道A/B，参数f是 指定Stop频率（单位：Hz） 。指令SULMD? 1会返 回通道A内部扫频模式的Stop截止频率。 f值可设 置范围0-102KHz，最小分辨率为 1mHz。                                                                            |
| SSLLD   | (?)   | i{,f}   | SSLLD指令用于设置或查询内部扫频模式在 Linear模式下的Step步进频率。参数i是指定通 道A/B，参数f是指定Step频率（单位：Hz） 。指 令SSLLD? 1会返回通道A的Step步进频率。f值 可设置范围0-102KHz，最小分辨率为1mHz。                                                                          |
| SSLGD   | (?)   | i{,x}   | SSLGD指令用于设置或查询内部扫频模式在 Log模式下的百分比数值。参数i是指定通道A/B，                                                                                                                                                             |

<!-- image -->

|       |     |         | 参数x是指定百分比数值（单位：%） 。指令SSLGD? 1会返回通道A内部扫频模式的百分比数值。x值 可设置范围0-100，最小分辨率为0.001。如x值 为50，代表50%。                                                                                                                           |
|-------|-----|---------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| STLMD | (?) | i{,j}   | STLMD指令用于设置或查询内部扫频模式下的 步进时间Time。参数i是指定通道A/B，参数j是 指定步进时间（单位：ms） 。指令STLMD?1会返回 通道A内部扫频模式的步进时间Time。j值可设置 范围1ms-100s，最小分辨率为1ms。                                                                                        |
| SWRMD | (?) | i{,j}   | SWRMD指令用于设置或查询内部扫频下运行模 式。参数i是指定通道A/B，参数j是指定执行模 式。j=0时选择扫频停止模式STOP， j=1时选择单 次扫频模式Single， j=2时选择循环扫频模式Loop。                                                                                                          |
| HARMD | (?) | i,j{,k} | HARMD指令用于设置或查询谐波检测。 发送该指令时i,j必须设置，参数i是指定通 道A/B ，j=1时选择谐波1，j=2时选择谐波2；参 数 k 可以设置为1到32767 之间的整数。HARMD i,j,k指令将会设置OE1022D检测输入参考频率的 k次谐波。参数k必须满足k*f ≤102 kHz。如果 k 次谐波的值大于102 kHz，那么谐波次数j会被自 动设置为满足条件k*f ≤102 kHz的k的最大值。 |
| SLVLD | (?) | i{,x}   | SLVLD指令用于设置或查询输出的同步正弦波 的幅度。参数i是指定通道A/B ，参数x指幅度电 压（实数值，单位：V） 。x的值会被四舍五入到 0.001V。参数 x 必须满足0.001 ≤x ≤5.000。                                                                                                           |
| SWVTD | (?) | i{,j}   | SWVTD指令用于设置或查询sine output的输 出类型。参数i是指定通道A/B ，j=0时选择固定 幅值模式输出，j=1时选择Linear线性扫幅模式输 出，j=2时选择Log对数扫幅模式输出，j=3时选 择DC直流输出模式。                                                                                              |
| SVLLD | (?) | i{,x}   | SVLLD指令用于设置或查询Sine Output 扫幅 模式下的Start开始幅值。 参数i是指定通道A/B， 参数x是指定开始幅值（单位：V） 。指令SVLLD? 1 会返回通道A扫幅的Start开始幅值。x值最小分 辨率为0.001V。x 必须满足0.001 ≤x ≤5.000。                                                                    |
| SVULD | (?) | i{,x}   | SVULD指令用于设置或查询Sine Output 扫幅 模式下的Stop截止幅值。参数i是指定通道A/B， 参数x是指定截止幅值（单位：V） 。指令SVULD? 1 会返回通道A扫幅的Stop截止幅值。 x值最小分辨 率0.001V。参数 x 必须满足0.001 ≤x ≤5.000。                                                                    |
| SVSLD | (?) | i{,x}   | SVSLD指令用于设置或查询Sine Output 扫幅 Linear模式下的Step步进幅值。参数i是指定通 道A/B，参数x是指定步进幅值（单位：V） 。指令                                                                                                                                  |

<!-- image -->

|           |     |       | SVSLD? 1会返回通道A的Linear模式扫幅的Step 步进幅值。X值最小分辨率0.001V。参数x必须满 足0.001 ≤x ≤5.000Vrms。                                                                      |
|-----------|-----|-------|-----------------------------------------------------------------------------------------------------------------------------------------------------|
| SVSGD     | (?) | i{,x} | SVSGD指令用于设置或查询Sine Output 扫幅 Log对数模式下的百分比数值。参数i是指定通道 A/B，参数x是指定百分比数值（单位：%） 。指令 SVSGD?1会返回通道A的Log对数扫幅模式的百分 比数值。X值最小分辨率0.001。x范围为0-100。 如x值为50，代表50%。 |
| SVTMD (?) |     | i{,x} | SVULD指令用于设置或查询Sine Output 扫幅 模式下的步进时间Time。参数i是指定通道A/B， 参数x是指定步进时间（单位：ms） 。指令SVULD? 1 会返回通道A扫幅的步进时间Time。x值可设置范 围1ms-100s，最小分辨率为 1ms。                 |
| SVRMD (?) |     | i{,j} | SVRMD指令用于设置或查询Sine Output扫幅 模式下的执行模式。参数i是指定通道A/B，参数 j是指定执行模式。j=0时选择扫幅停止模式Stop， j=1时选择单次扫幅模式Single，j=2时选择循环 扫幅模式Loop。                                |
| SVDCD     | (?) | i{,x} | SVDCD指令用于设置或查询Sine Output直流 模式下的直流输出幅值。参数i是指定通道A/B ， 参数x是指定幅度电压（实数值，单位：V） 。参数 x设置范围-10V≤x≤10V，分辨率为 0.001V。                                          |

<!-- image -->

## 5.2.2 Equation 指令

| EQCDD ? i,j{, k, l, m}   | EQCDD 指令用于设置或查询四个Equation公 式中A、B和C三个系数所选取的参数值。发送该 指令时参数i、 j必须设置， 参数i是指定通道A/B， 参数j是指定四条公式。j=1时选择公式1,j=2时 选择公式2，j=3时选择公式3，j=4时选择公式4。 k、l、m分别代表Equation中的A，B，C。 参数k、l、m的选择具体如下：                       | EQCDD 指令用于设置或查询四个Equation公 式中A、B和C三个系数所选取的参数值。发送该 指令时参数i、 j必须设置， 参数i是指定通道A/B， 参数j是指定四条公式。j=1时选择公式1,j=2时 选择公式2，j=3时选择公式3，j=4时选择公式4。 k、l、m分别代表Equation中的A，B，C。 参数k、l、m的选择具体如下：                       |
|--------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                          | k，l，m                                                                                                                                                                                              | Parameter                                                                                                                                                                                          |
||0|R|
||1|X|
||2|Y|
||3|θ|
||4|Rh1|
||5|Xh1|
||6|Yh1|
||7|θh1|
||8|Rh2|
||9|Xh2|
||10|Yh2|
||11|θh2|
||12|Noise|
||13|A1|
||14|A2|
||15|A3|
||16|A4|
||17|Freq|
||18|C1|
||19|C2|
||例如发送指令EQCD 1,2,0,18,17就代表了把 通道A的公式2配置为：E2 = R * C1/Freq。 指令EQCDD? i,j用于查询通道i的公式j所 配置的系数，会返回A、B和C三个对应参数值的 序号，三个序号以逗号(,)分隔开。例如，发送指 令EQCD? 1, 2 后返回字符串为"0,18,17"，那么表 示通道A公式2的A系数为R值，B系数为C1，C 系数为Freq。|例如发送指令EQCD 1,2,0,18,17就代表了把 通道A的公式2配置为：E2 = R * C1/Freq。 指令EQCDD? i,j用于查询通道i的公式j所 配置的系数，会返回A、B和C三个对应参数值的 序号，三个序号以逗号(,)分隔开。例如，发送指 令EQCD? 1, 2 后返回字符串为"0,18,17"，那么表 示通道A公式2的A系数为R值，B系数为C1，C 系数为Freq。|
| EQCSD (?) i, j{, x}      | EQCSD指令用于设置或查询两个系数值C1、 C2。 发送该指令时参数i、j必须设置，参数i是指定 通道A/B，参数j是指定系数。j=1时选择系数C1 的设置, j=2时选择系数C2的设置。                                                                                                    | EQCSD指令用于设置或查询两个系数值C1、 C2。 发送该指令时参数i、j必须设置，参数i是指定 通道A/B，参数j是指定系数。j=1时选择系数C1 的设置, j=2时选择系数C2的设置。                                                                                                    |

<!-- image -->

| 参数x用于设置系数值， 范围是-10.000≤x ≤ 10.000。 例如发送指令EQCS 1,2,5.00会设置通道A的 系数C2的值为5.00。   |
|------------------------------------------------------------------------------|

<!-- image -->

## 5.2.3 输入与滤波器指令

| ISRCD (?)i{,j}   | ISRCD指令用于设置或查询输入信号的方式。 参数i是指定通道A/B， 参数j是指定输入信 号类型。参数j=0时选择A(单端电压信号输入)； j=1时选择A-B(差分电压输入)；j=2时选择 1 M Ω(电流输入，放大倍数10E6 V/A)；j=3时选择 100 MΩ(电流输入，放大倍数10E8 V/A)。   |
|------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------|
| IGNDD (?)i{,j}   | IGNDD指令用于设置或查询输入接地方式。 参数i是指定通道A/B， 参数j是指定输入接 地方式。参数j=0时选择Float模式(输入接头地 与仪器地通过 10kΩ电阻隔离)；j=1 时选择 Ground模式(输入接头地与仪器地通过10Ω电阻 短接)。                               |
| ICPLD (?)i{,j}   | ICPLD指令用于设置或查询输入耦合方式。 参数i是指定通道A/B， 参数j是指定输入耦 合方式。参数j=0时选择AC(交流耦合输入)；j=1 时选择DC(直流耦合输入)。                                                                       |
| ILIND (?)i{,j}   | ILIND指令用于设置或查询陷波器的开启或 关闭状态。 参数i是指定通道A/B， 参数j是指定陷波器 状态。参数j=0时选择关闭陷波器；j=1时选择开 启 50Hz 陷波器；j=2时选择同时开启 50Hz 和 100Hz陷波器；j=3时选择开启100Hz陷波器。                          |

<!-- image -->

## 5.2.4 灵敏度和时间常数指令

| SENSD (?) i{,j}   | SENSD指令用于设置或查询系统的灵敏（sensitivity)。 参数i用于指定通道A/B，参数j用于选择不同的量程                                                             | SENSD指令用于设置或查询系统的灵敏（sensitivity)。 参数i用于指定通道A/B，参数j用于选择不同的量程                                                             |
|-------------------|-------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
| SENSD (?) i{,j}   | j sensitivity                                                                                                           | j sensitivity                                                                                                           |
||0: 1 nV/fA|14: 50 uV/pA|
||1: 2 nV/fA|15: 100 uV/pA|
||2: 5 nV/fA|16: 200 uV/pA|
||3: 10 nV/fA|17: 500 uV/pA|
||4: 20 nV/fA|18: 1 mV/nA|
||5: 50 nV/fA|19: 2 mV/nA|
||6: 100 nV/fA|20: 5 mV/nA|
||7: 200 nV/fA|21: 10 mV/nA|
||8: 500 nV/fA|22: 20 mV/nA|
||9: 1 uV/pA|23: 50 mV/nA|
||10: 2 uV/pA|24: 100 mV/nA|
||11: 5 uV/pA|25: 200 mV/nA|
||12: 10 uV/pA|26: 500 mV/nA|
||13: 20 uV/pA|27: 1 V/uA|
| RMODD (?) i{,j}   | RMODD指令用于设置或查询动态储备模式。参数i用于指 定通道A/B，参数j用于指定动态储备模式。参数j=0时选择 Low Noise；j=1 时选择Normal；j=2时选择High Reserve。                   | RMODD指令用于设置或查询动态储备模式。参数i用于指 定通道A/B，参数j用于指定动态储备模式。参数j=0时选择 Low Noise；j=1 时选择Normal；j=2时选择High Reserve。                   |
||OFLTD指令用于设置或查询滤波器的时间常数。参数i用 于指定通道A/B，参数j用于选择不同的时间常数. 具体如下：|OFLTD指令用于设置或查询滤波器的时间常数。参数i用 于指定通道A/B，参数j用于选择不同的时间常数. 具体如下：|
||j time constant j time 0: 10 us 9: 300 ms|constant|
||1: 30 us|10: 1 s|
| OFLTD (?) i{,j}   | 2: 100 us                                                                                                               |                                                                                                                         |
| RMODD (?) i{,j}   |                                                                                                                         | 11: 3 s                                                                                                                 |
||3: 300 us|12: 10 s|
||4: 1 ms|13: 30 s|
||5: 3 ms|14: 100 s|
||6: 10 ms|15: 300 s|
||7: 30 ms|16: 1000 s|
| OFSLD (?) i{,j}   | OFSLD指令用于设置或查询低通滤波器的滚降。 参数i用于指定通道A/B， 参数j用于指定滤波器的滚降。 参数j=0 时选择6dB/oct；j=1时选择12 dB/oct；j=2时选 择18 dB/oct；j=3时选择24 dB/oct。 | OFSLD指令用于设置或查询低通滤波器的滚降。 参数i用于指定通道A/B， 参数j用于指定滤波器的滚降。 参数j=0 时选择6dB/oct；j=1时选择12 dB/oct；j=2时选 择18 dB/oct；j=3时选择24 dB/oct。 |
| SYNCD (?) i{,j}   | SYNCD指令用于设置或查询同步滤波器的开关状态。一般 当参考频率低于200Hz时需要开启同步滤波器。参数i用于 指定通道A/B，参数j用于指定同步滤波器的开关状态。参数 j=0时关闭同步滤波器；j=1时开启同步滤波器。          | SYNCD指令用于设置或查询同步滤波器的开关状态。一般 当参考频率低于200Hz时需要开启同步滤波器。参数i用于 指定通道A/B，参数j用于指定同步滤波器的开关状态。参数 j=0时关闭同步滤波器；j=1时开启同步滤波器。          |

<!-- image -->

## 5.2.5 显示和输出指令

FPOPD (?) j {, k}

<!-- image -->

FPOPD 指令用于设置或查询OE1022D后面板 的输出通道。

发送该指令时参数j必须设置，j=1时选择 CH1 （输出通道一） ； j=2 时选择 CH2 （输出通道二） 。 参数k用于选择输出值的类型.

## 具体如下：

|   k | Parameter   |
|-----|-------------|
|   0 | A-R         |
|   1 | A-X         |
|   2 | A-Y         |
|   3 | A-θ         |
|   4 | A-Rh1       |
|   5 | A-Xh1       |
|   6 | A-Yh1       |
|   7 | A-θh1       |
|   8 | A-Rh2       |
|   9 | A-Xh2       |
|  10 | A-Yh2       |
|  11 | A-θh2       |
|  12 | A-Noise     |
|  13 | A-E1        |
|  14 | A-E2        |
|  15 | A-E3        |
|  16 | A-E4        |
|  17 | B-R         |
|  18 | B-X         |
|  19 | B-Y         |
|  20 | B-θ         |
|  21 | B-Rh1       |
|  22 | B-Xh1       |
|  23 | B-Yh1       |
|  24 | B-θh1       |
|  25 | B-Rh2       |
|  26 | B-Xh2       |
|  27 | B-Yh2       |
|  28 | B-θh2       |
|  29 | B-Noise     |
|  30 | B-E1        |
|  31 | B-E2        |
|  32 | B-E3        |

| 33                                                                                                                                                                                                                                     | B-E4                                                                                                                                                                                                                                   |
|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 34                                                                                                                                                                                                                                     | AUXOUT                                                                                                                                                                                                                                 |
| OEXPD指令用于设置或查询相应参数值的偏 置和放大倍数。发送该指令时参数j和k必须设 置，j=1时选择CH1（输出通道一） ；j=2时选择 CH2（输出通道二） 。参数k用于选择参数值的类 型. 具体如下：                                                                                                                               | OEXPD指令用于设置或查询相应参数值的偏 置和放大倍数。发送该指令时参数j和k必须设 置，j=1时选择CH1（输出通道一） ；j=2时选择 CH2（输出通道二） 。参数k用于选择参数值的类 型. 具体如下：                                                                                                                               |
| k                                                                                                                                                                                                                                      | Parameter                                                                                                                                                                                                                              |
| 0                                                                                                                                                                                                                                      | A-R                                                                                                                                                                                                                                    |
| 1                                                                                                                                                                                                                                      | A-X                                                                                                                                                                                                                                    |
| 2                                                                                                                                                                                                                                      | A-Y                                                                                                                                                                                                                                    |
| 3                                                                                                                                                                                                                                      | A-Rh1                                                                                                                                                                                                                                  |
| 4                                                                                                                                                                                                                                      | A-Xh1                                                                                                                                                                                                                                  |
| 5                                                                                                                                                                                                                                      | A-Yh1                                                                                                                                                                                                                                  |
| 6                                                                                                                                                                                                                                      | A-Rh2                                                                                                                                                                                                                                  |
| 7                                                                                                                                                                                                                                      | A-Xh2                                                                                                                                                                                                                                  |
| 8                                                                                                                                                                                                                                      | A-Yh2                                                                                                                                                                                                                                  |
| 9                                                                                                                                                                                                                                      | A-Noise                                                                                                                                                                                                                                |
| 10                                                                                                                                                                                                                                     | B-R                                                                                                                                                                                                                                    |
| 11                                                                                                                                                                                                                                     | B-X                                                                                                                                                                                                                                    |
| 12                                                                                                                                                                                                                                     | B-Y                                                                                                                                                                                                                                    |
| 13                                                                                                                                                                                                                                     | B-Rh1                                                                                                                                                                                                                                  |
| 14                                                                                                                                                                                                                                     | B-Xh1                                                                                                                                                                                                                                  |
| 15                                                                                                                                                                                                                                     | B-Yh1                                                                                                                                                                                                                                  |
| 16                                                                                                                                                                                                                                     | B-Rh2                                                                                                                                                                                                                                  |
| 17                                                                                                                                                                                                                                     | B-Xh2                                                                                                                                                                                                                                  |
| 18                                                                                                                                                                                                                                     | B-Yh2                                                                                                                                                                                                                                  |
| 19                                                                                                                                                                                                                                     | B-Noise                                                                                                                                                                                                                                |
| 参数x用于设置偏置值， 范围是(-100.00≤x ≤100.00)%.参数l用于设置输出放大倍数， 范围 是(1≤l ≤256)。 例如发送指令OEXPD1，2,50.00,2会设置通 道1的参数值Y的偏置为50%， 输出放大倍数为2 倍。该指令中x和l值都需要发送。 指令OEXPD?1,k用于查询输出通道一的参数 k对应参数值的偏置值和放大倍数。返回的字符 串包括偏置值和放大倍数，两者以逗号(,)分隔 开。例如，发送指令OEXPD?1,2后返回字符串为 | 参数x用于设置偏置值， 范围是(-100.00≤x ≤100.00)%.参数l用于设置输出放大倍数， 范围 是(1≤l ≤256)。 例如发送指令OEXPD1，2,50.00,2会设置通 道1的参数值Y的偏置为50%， 输出放大倍数为2 倍。该指令中x和l值都需要发送。 指令OEXPD?1,k用于查询输出通道一的参数 k对应参数值的偏置值和放大倍数。返回的字符 串包括偏置值和放大倍数，两者以逗号(,)分隔 开。例如，发送指令OEXPD?1,2后返回字符串为 |

<!-- image -->

| SPEDD (?) j{,k}   | SPEDD指令用于设置或查询Channel Output 的执行模式。 参数j=1时选择CH1 （输出通道一） ； j=2时选择CH2（输出通道二） 。参数k=0时选择 为Slow模式， k=1时选择Fast模式。 Fast模式时只能选择R，X，Y值的输出，当 Slow模式当前选择不是R,X,Y值时， 切换到Fast 模式时，输出值会自动选择为R值。   |
|-------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| CAUXD (?) j{,x}   | CAUXD指令用于设置或查询Channel Output 在AUXOUT输出模式时的直流幅值。 参数j=1时选 择CH1（输出通道一） ；j=2时选择CH2（输出通 道二） 。参数x是指定幅度电压（实数值，单位： V） 。参数x设置范围-10V≤x≤10V，分辨率为 0.001V。                                      |

<!-- image -->

## 5.2.6 保存读取设置指令

| SSETD i   | SSETD i 指令用于把 OE1022D 当前的设置 保存到设置缓存区中，即 Setting buffer i(1≤i≤4) 。 Setting buffer 里 面 的 配 置 信 息 在 OE1022D 断电后可保存，用于下次开机时使 用。                                                 |
|-----------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| RSETD i   | RSETD i 指令用于读取 Setting buffer i(1≤i≤5) 里的设置。读取成功后， OE1022D 内 部参数将会被设置成与 Setting buffer i 里面 相同的参数。 i=1,2,3,4 为用户自定义的设置， i=5 为系 统出厂默认设置。例如，指令 RSETD 5 设备 内部的所有状态与参数都会重置为默认值。 |

<!-- image -->

## 5.2.7 自动设置指令

| AGAND   | i AGAND指令用于打开自动设置增益的功 能。参数i用于指定通道A/B。该指令作用 和在前面板按下[Auto Gain]键的作用是一 样的。 如果时间常数设置较长，设置自动增益   | 将会耗费一些时间。                                                                                                                                                                                                |
|---------|---------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| ARSVD   | i                                                                                           | ARSVD指令用于打开自动设置动态储备 的功能。参数i用于指定通道A/B。该指令 作用和在前面板按下[Auto Reserve]键的作 用是一样的。                                                                                                                               |
| APHSD   | i                                                                                           | 自动设置动态储备需要耗费一些时间。 APHSD指令用于打开自动设置相位的功 能。参数i用于指定通道A/B。该指令作用 和在前面板按下[Auto Phase]键的作用是一 样的。 自动设置相位需要耗费一些时间。在自 动设置完成之前，不要再次发送APHSDi指 令。另外，如果相位不稳定，那么该指令将 无效。 可以通过PHASD (?) i指令来查询当前 的相位偏移值，以确定APHSD指令有没有生 效。 |
| ASCLD   | i                                                                                           | ASCLD指令用于打开自动设置显示刻度 的功能。参数i用于指定通道A/B。该指令 作用和在前面板按下[Auto Scale]键的作用 是一样的。                                                                                                                                 |

<!-- image -->

## 5.2.8 数据存储指令

| SRATD   | (?) i{,x}   | SRATD指令用于设置或查询数据采样 的步进时间。参数i用于指定通道A/B，参 数x用于设置步进时间。指令SRATD? 1会 返回通道A采样的步进时间值。x值可设置 范围1ms-100s，最小分辨率为 1ms。                                                                           | SRATD指令用于设置或查询数据采样 的步进时间。参数i用于指定通道A/B，参 数x用于设置步进时间。指令SRATD? 1会 返回通道A采样的步进时间值。x值可设置 范围1ms-100s，最小分辨率为 1ms。                                                                           |
|---------|-------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| SLEND   | (?) i{,j}   | SLEND指令用于设置或查询数据采样 的长度。参数i用于指定通道A/B，参数j 用于设置采样长度。最大值只能是16384。                                                                                                                       | SLEND指令用于设置或查询数据采样 的长度。参数i用于指定通道A/B，参数j 用于设置采样长度。最大值只能是16384。                                                                                                                       |
|         |             | SSLED 指令用于设置或查询四个缓存 区所选取的参数值。发送该指令时参数i， j必须设置，参数i用于指定通道A/B，参 数j用于指定参数值。 参数j=1时选择缓存 区Buffer1, j=2 时选择缓存区Buffer2， j=3 时选择缓存区Buffer3，j=4时选择缓 存区Buffer4。 k表示缓存Buffer中记录的测量值 参数j的选择具体如下： | SSLED 指令用于设置或查询四个缓存 区所选取的参数值。发送该指令时参数i， j必须设置，参数i用于指定通道A/B，参 数j用于指定参数值。 参数j=1时选择缓存 区Buffer1, j=2 时选择缓存区Buffer2， j=3 时选择缓存区Buffer3，j=4时选择缓 存区Buffer4。 k表示缓存Buffer中记录的测量值 参数j的选择具体如下： |
|||k 0 1 2|Parameter|
||||R|
||||X|
||||Y|
|||3|θ|
|||4|Rh1|
| SSLED   | i,j{,k}     | 5                                                                                                                                                                                   | Xh1                                                                                                                                                                                 |
| (?)     |             | 6                                                                                                                                                                                   | Yh1                                                                                                                                                                                 |
|         |             | 7                                                                                                                                                                                   | θh1                                                                                                                                                                                 |
|||8|Rh2|
|||9|Xh2|
|||10|Yh2|
|||11|θh2|
|||12|Noise|
|||13|A1|
|||14|A2|
|||15|A3|
|||16|A4|
|||17|E1|
|||18|E2|
|||19|E3|
|||20|E4|

<!-- image -->

| STRGD (?) i{,j}   | STRFGD指令用于设置或查询数据采样 的触发方式，参数i用于指定通道A/B，参 数j用于指定触发方式。j=0时选择内部触 发方式INT，j=1时选择外部触发方式EXT。                                     |
|-------------------|---------------------------------------------------------------------------------------------------------------------------|
| SPRMD (?) i{,j}   | SPRMD指令用于设置或查询数据采样 的运行模式，参数i用于指定通道A/B，参 数j用于指定运行模式。j=0时选择为单次 模式Single， j=1时选择循环模式Loop。                                    |
| STRDD i           | STRDD指令用来开启或继续当前的数 据采样功能。 参数i用于指定通道A/B，i=1 时开始或继续通道A的采样功能，i=2时开 始或继续通道B的采样功能，i=3时选择为 开始或继续通道A和通道B的采样功能。                   |
| PAUSD i           | PAUSD指令用来暂停当前的数据采样 功能。参数i用于指定通道A/B，i=1时选 择为暂停通道A的采样功能，i=2时选择为 暂停通道B的采样功能，i=3时选择为暂停 通道A和通道B的采样功能。                          |
| RESTD i           | RESTD指令用于重置数据缓存区。该指 令会清空四个数据缓存区Buffer1~4。参数 i用于指定通道A/B， i=1时选择为重置通 道A的采数据缓存区，i=2时选择为重置通 道B的数据缓存区，i=3时选择为重置通道 A和通道B的数据缓存区。 |

<!-- image -->

## 5.2.9 数据读取指令

|                       | OUTPD ? i,j指令用于读取单个参数值。 参数i用于指定通道A/B，i=1时指定为通道A 的读取，i=2时指定为通道B的读取。参数j 对应于下表： 参数j的选择具体如下：                                                                                                                                                              | OUTPD ? i,j指令用于读取单个参数值。 参数i用于指定通道A/B，i=1时指定为通道A 的读取，i=2时指定为通道B的读取。参数j 对应于下表： 参数j的选择具体如下：                                                                                                                                                              |
|-----------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                       | j                                                                                                                                                                                                                                                     | Parameter                                                                                                                                                                                                                                             |
||0|X|
||1|Y|
||2|R|
||3|θ|
||4|Xh1|
||5|Yh1|
||6|Rh1|
||7|θh1|
| OUTPD ? i,j           | 8                                                                                                                                                                                                                                                     | Xh2                                                                                                                                                                                                                                                   |
|                       | 9                                                                                                                                                                                                                                                     | Yh2                                                                                                                                                                                                                                                   |
||10|Rh2|
||11|θh2|
||12|Noise|
||13|A1|
||14|A2|
||15|A3|
||16|A4|
||17|Freq|
| SNAPD ? i,j,k{,l,m,n} | 所选参数的值以ASCII浮点数的格式返 回，以伏特(V)或度(°) 或（Hz）为单位。该 指令仅用作查询。                                                                                                                                                                                                 | 所选参数的值以ASCII浮点数的格式返 回，以伏特(V)或度(°) 或（Hz）为单位。该 指令仅用作查询。                                                                                                                                                                                                 |
|                       | SNAPD ? i,j,k指令用于在同一个时间点 记录最多5个不同的参数值。参数i用于指定 通道A/B，i=1时指定为通道A的读取，i=2时 指定为通道B的读取。 例如，指令SNAPD?1用于在同一时刻查询 通道A的X和Y(或R，θ和F)值，该功能在时 间常数很短的时候非常实用。因为如果使用 OUTPD?指令来读取两个不同的参数值，可能会 有一定的延时，当这个延时值大于时间常数的 时候，就会使得读取的两个数据不是同一测量 条件下测量所得。 SNAPD?i,j,k指令需要至少3个参数，最 | SNAPD ? i,j,k指令用于在同一个时间点 记录最多5个不同的参数值。参数i用于指定 通道A/B，i=1时指定为通道A的读取，i=2时 指定为通道B的读取。 例如，指令SNAPD?1用于在同一时刻查询 通道A的X和Y(或R，θ和F)值，该功能在时 间常数很短的时候非常实用。因为如果使用 OUTPD?指令来读取两个不同的参数值，可能会 有一定的延时，当这个延时值大于时间常数的 时候，就会使得读取的两个数据不是同一测量 条件下测量所得。 SNAPD?i,j,k指令需要至少3个参数，最 |

<!-- image -->

| 选择具体如下：                                                                                                                                                                                                                    | 选择具体如下：                                                                                                                                                                                                                    |
|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| j，k，l，m，n                                                                                                                                                                                                                  | Parameter                                                                                                                                                                                                                  |
| 0                                                                                                                                                                                                                          | X                                                                                                                                                                                                                          |
| 1                                                                                                                                                                                                                          | Y                                                                                                                                                                                                                          |
| 2                                                                                                                                                                                                                          | R                                                                                                                                                                                                                          |
| 3                                                                                                                                                                                                                          | θ                                                                                                                                                                                                                          |
| 4                                                                                                                                                                                                                          | Frequency                                                                                                                                                                                                                  |
| 5                                                                                                                                                                                                                          | Xh1                                                                                                                                                                                                                        |
| 6                                                                                                                                                                                                                          | Yh1                                                                                                                                                                                                                        |
| 7                                                                                                                                                                                                                          | Rh1                                                                                                                                                                                                                        |
| 8                                                                                                                                                                                                                          | θh1                                                                                                                                                                                                                        |
| 9                                                                                                                                                                                                                          | Xh2                                                                                                                                                                                                                        |
| 10                                                                                                                                                                                                                         | Yh2                                                                                                                                                                                                                        |
| 11                                                                                                                                                                                                                         | Rh2                                                                                                                                                                                                                        |
| 12                                                                                                                                                                                                                         | θh2                                                                                                                                                                                                                        |
| 13                                                                                                                                                                                                                         | Noise                                                                                                                                                                                                                      |
| 14                                                                                                                                                                                                                         | A1                                                                                                                                                                                                                         |
| 15                                                                                                                                                                                                                         | A2                                                                                                                                                                                                                         |
| 16                                                                                                                                                                                                                         | A3                                                                                                                                                                                                                         |
| 17                                                                                                                                                                                                                         | A4                                                                                                                                                                                                                         |
| 18                                                                                                                                                                                                                         | E1                                                                                                                                                                                                                         |
| 19                                                                                                                                                                                                                         | E2                                                                                                                                                                                                                         |
| 20                                                                                                                                                                                                                         | E3                                                                                                                                                                                                                         |
| 21                                                                                                                                                                                                                         | E4                                                                                                                                                                                                                         |
| 返回的值是一个单一的字符串，该字符串 内不同值之间用逗号(,)分隔， 并且顺序是按照 发送指令时j, k, l, m, n的顺序。例如，发 送SNAPD? 1,1,2,5,4会返回通道A的X、Y、 Frequency和θ的值。这些值均放在同一个字 符串中，例如： "0.951359,0.0253297,1000.00,1.234"。 第一个是X值，第二个是Y值，第三个是频率 值，第四个是θ的值。 该指令仅用作同时查询几个不同的参数。 | 返回的值是一个单一的字符串，该字符串 内不同值之间用逗号(,)分隔， 并且顺序是按照 发送指令时j, k, l, m, n的顺序。例如，发 送SNAPD? 1,1,2,5,4会返回通道A的X、Y、 Frequency和θ的值。这些值均放在同一个字 符串中，例如： "0.951359,0.0253297,1000.00,1.234"。 第一个是X值，第二个是Y值，第三个是频率 值，第四个是θ的值。 该指令仅用作同时查询几个不同的参数。 |
| OAUXD?指令用于读取后面板AUXIN接口的 输入电压值。参数i用于指定AUXIN1~4，i=1 时指定为AUXIN1的读取， i=4 时指定为AUXIN4 的读取。返回值以伏特(V)为单位。该指令仅用 作查询。                                                                                                                | OAUXD?指令用于读取后面板AUXIN接口的 输入电压值。参数i用于指定AUXIN1~4，i=1 时指定为AUXIN1的读取， i=4 时指定为AUXIN4 的读取。返回值以伏特(V)为单位。该指令仅用 作查询。                                                                                                                |
| SPTSD ?指令用于查询存储在数据缓存区 的点的数量。参数i用于指定通道A/B，i=1                                                                                                                                                                               | SPTSD ?指令用于查询存储在数据缓存区 的点的数量。参数i用于指定通道A/B，i=1                                                                                                                                                                               |

<!-- image -->

|                 | 时指定为通道A的读取，i=2时指定为通道B 的读取。该指令可在任何时候发送。如果Data buffer被重置，就会返回0值。 该指令仅用作查询。                                                                                                                                                                                                                                                                                  |
|-----------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| TRCAD ? i,j,k,l | TRCAD ? i,j,k,l指令用于查询存储在 Buffer j数据缓存区的数据Buffer1~Buffer4。 返回值是ASCII浮点数的形式。不同点数 之间用逗号(,)分隔开， 并且最后一个点会伴随 着终结符。例如，两个点的返回值可能是 "-1.234567e-009,+7.654321e-009,"。 参数i,j, k, l都需要伴随着TRCAD?指令 发送。参数i用于指定通道A/B，i=1时指定为 通道A的读取，i=2时指定为通道B的读取。 参数 j 用于选择需要读取的数据缓存区 （j=1,2，3,4） ；读取的数据是从数据缓存区中 的第k (k≥0)个数据开始的；读取的总长度是 l (l≥1)。当读取单个数据时，设置l=1。 k+l的值不能超过数据缓存区Buffer里面 |
| INOVD ？ i       | 存储的最大值16384。 INOVD ？指令用于查询当前输入信号是否 过大，从而导致前级过载。参数i用于指定通 道A/B，i=1时指定为通道A的读取，i=2时指 定为通道B的读取。正常返回0值，当输入信 号过大，前级过载时返回1。 该指令仅用作查询。                                                                                                                                                                                                                             |
| GNOVD ？ i       | GNOVD ？指令用于查询当前输入信号下， 所选的灵敏度以及动态储备过小，从而导致前 级增益过载。参数i用于指定通道A/B，i=1 时指定为通道A的读取，i=2时指定为通道B 的读取。正常返回0值，当所选灵敏度以及动 态储备过小的时候，会导致前级增益过大，从 而过载，此时返回值为1。 该指令仅用作查询。                                                                                                                                                                                                  |
| *PLLD ？ i       | *PLLD ？指令用于查询当前频率下，内部 锁相环是否锁定在待测参考。参数i用于指定 通道A/B，i=1时指定为通道A的读取，i=2时 指定为通道B的读取。内部参考时，默认返回 值为0；外部参考时，锁相环的频率跟随外部 参考的频率变化而变化，锁相环锁定在外部参 考频率时返回1，其他情况返回0。 该指令仅用作查询。该指令仅用作查询。                                                                                                                                                                                    |

<!-- image -->

## 5.2.10 复位与 IDN 指令

| *RSTD   | *RSTD指令用于复位OE1022D。设备内 的数据缓存区内的数据也会丢失。                                                                                   |
|---------|--------------------------------------------------------------------------------------------------------------------------|
| *IDND ? | *IDND ?指令用于查询OE1022D的ID， 格式为'SSI LIA-OE1022D，SNXXXXXX， VerXXX' 。其中第一个为型号，如OE1022D； 第二个为序列号，如SN00001；第三个为硬 件版本号，如Ver1.00。 |

<!-- image -->

## 5.2.11 全局数据配置读取指令

| RALL ?   | RALL? 指令是 USB2.0 专用，在 RS232 接口没有该指令。 RALL? 指令用于读取 OE1022D 的所有测量数据和当前配置 信息。返回数据长度是 12288Bytes ，数据中间没有逗号隔开，按 照固定空间分配数据组合。 RALL? 指令返回数据每 50ms 更新一 次，返回之前 50ms 的测量数据，数据采样间隔是 1ms ，也就是 每次返回之前的 50 个测量数据。例如前 400 个 Bytes 数据为 50 个 X 值数据，每个 X 值是 64 位浮点数，占用 8 个 Bytes ，按照时 间先后顺序排列 50 个 X 值；然后到 Y 值……前 8000Bytes 是返 回测量数据，然后的 1216Bytes 是当前配置信息，每个配置信息 不像数据会返回 50 个值， 而是只返回 1 次参数。 最后的 3072Bytes 是空字符，合计 12288 Bytes 。   |
|----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|

## RALL? 返回数据格式如下：

| 分类                | 返回数据                        | 数据位置      |
|-------------------|-----------------------------|-----------|
| 测量数据              | 50 个 A 通道 X 值（ 64 位浮点数）     | 0~399     |
||50 个 A 通道 Y 值（ 64 位浮点数）|400~799|
||50 个 A 通道频率值（ 64 位浮点数）|800~1199|
||50 个 A 通道 Noise 值（ 64 位浮点数）|1200~1599|
||50 个 A 通道 Xh1 值（ 64 位浮点数）|1600~1999|
||50 个 A 通道 Yh1 值（ 64 位浮点数）|2000~2399|
||50 个 A 通道 Xh2 值（ 64 位浮点数）|2400~2799|
||50 个 A 通道 Yh2 值（ 64 位浮点数）|2800~3199|
||50 个 B 通道 X 值（ 64 位浮点数）|3200~3599|
||50 个 B 通道 Y 值（ 64 位浮点数）|3600~3999|
||50 个 B 通道频率值（ 64 位浮点数）|4000~4399|
||50 个 B 通道 Noise 值（ 64 位浮点数）|4400~4799|
||50 个 B 通道 Xh1 值（ 64 位浮点数）|4800~5199|
||50 个 B 通道 Yh1 值（ 64 位浮点数）|5200~5599|
||50 个 B 通道 Xh2 值（ 64 位浮点数）|5600~5999|
||50 个 B 通道 Yh2 值（ 64 位浮点数）|6000~6399|
||50 个 AUXADC1 值（ 64 位浮点数）|6400~6799|
||50 个 AUXADC2 值（ 64 位浮点数）|6800~7199|
||50 个 AUXADC3 值（ 64 位浮点数）|7200~7599|
||50 个 AUXADC4 值（ 64 位浮点数）|7600~7999|
| 通道 Ref Phase 配置参数 | <Ref.Phase> 设置（ 32 位浮点数）    | 8200~8203 |
|                   | <Ref.Source> 设置（ 8 位整型数）    | 8204      |
||当前频率值（ 64 位浮点数）|8205~8212|
||内部频率值（ 64 位浮点数）|8213~8220|
||<Ref.slope> 设置（ 8 位整型数）|8221|
||<Harmonic 1> 设置（ 64 位整型数）|8222~8229|
||<Harmonic 2> 设置（ 64 位整型数）|8230~8237|

<!-- image -->