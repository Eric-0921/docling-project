## 5.1 OE1022D 命令语法

上位机与 OE1022D 的通信使用 ASCII 字符来进行。命令符使用大写，所有命令均由四个 命令字符（如有必要可带上参数）和一个命令终结符组成。当使用 RS232 转 USB 接口通信 时，终结字符必须是一个换行符 <lf> 或回车符 <cr> 。 OE1022D 只有在收到命令终结符时，才 会执行用户输入的命令。命令可能需要一个或多个参数，多个参数之间用逗号分隔 (,) 。

多个命令可以在同一命令行发送，但命令之间需要添加分号 (;) 。在同一行发送多个命令 和分别发送几个独立命令的区别在于：当一个命令行被解析和执行时，在整个命令行执行完 成之前， OE1022D 无法执行其他命令。

OE1022D 有一个容量为 256 个字符的输入缓存区，并根据接收命令的顺序来处理命令。 当缓存区写满时，最新命令将会把最旧并已执行命令覆盖。建议输入多个命令时不要超过 256 个字符。

OE1022D 允许用户通过命令查询内部参数的当前值。 查询命令的格式为由当前命令后加 上一个问号 '?' 并省略原命令所需的一个或多个参数。 OE1022D 以 ASCII 字符串的形式返回用 户所查询的参数，如果一个命令行中发送多个查询 ( 用分号隔开 ) 的话，应答将会一个一个地 返回，每个都对应一个终结符。

另外为了保证兼容性， OE1022D 仍然支持 OE1022 的通讯指令，但只能返回 A 通道的测 量数据。如果要返回 B 通道测量数据，必须使用本章介绍的命令。

| FMODD 1,1 <cr> | 设置通道A的参考源为内部参考 |
|---|---|
| FREQD 1,10E3 <cr> | 设置通道A的内部参考信号频率为10kHz |
| OUTPD? 2,1 <cr> | 查询通道B的通道1的输出值 |


<!-- image -->


<!-- Page 63 -->

OE1022D DSP Lock-In Amplifier

57
