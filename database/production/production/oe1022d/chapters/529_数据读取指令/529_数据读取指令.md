## 5.2.9 数据读取指令

|  | OUTPD ? i,j指令用于读取单个参数值。 参数i用于指定通道A/B，i=1时指定为通道A 的读取，i=2时指定为通道B的读取。参数j 对应于下表： 参数j的选择具体如下： |  |
|---|---|---|
|  | j | Parameter |
|  | 0 | X |
|  | 1 | Y |
|  | 2 | R |
|  | 3 | θ |
|  | 4 | Xh1 |
|  | 5 | Yh1 |
|  | 6 | Rh1 |
|  | 7 | θh1 |
| OUTPD ? i,j | 8 | Xh2 |
|  | 9 | Yh2 |
|  | 10 | Rh2 |
|  | 11 | θh2 |
|  | 12 | Noise |
|  | 13 | A1 |
|  | 14 | A2 |
|  | 15 | A3 |
|  | 16 | A4 |
|  | 17 | Freq |
| SNAPD ? i,j,k{,l,m,n} | 所选参数的值以ASCII浮点数的格式返 回，以伏特(V)或度(°) 或（Hz）为单位。该 指令仅用作查询。 |  |
|  | SNAPD ? i,j,k指令用于在同一个时间点 记录最多5个不同的参数值。参数i用于指定 通道A/B，i=1时指定为通道A的读取，i=2时 指定为通道B的读取。 例如，指令SNAPD?1用于在同一时刻查询 通道A的X和Y(或R，θ和F)值，该功能在时 间常数很短的时候非常实用。因为如果使用 OUTPD?指令来读取两个不同的参数值，可能会 有一定的延时，当这个延时值大于时间常数的 时候，就会使得读取的两个数据不是同一测量 条件下测量所得。 SNAPD?i,j,k指令需要至少3个参数，最 |  |


<!-- image -->


<!-- Page 79 -->

OE1022D DSP Lock-In Amplifier

73

| 选择具体如下： |  |
|---|---|
| j，k，l，m，n | Parameter |
| 0 | X |
| 1 | Y |
| 2 | R |
| 3 | θ |
| 4 | Frequency |
| 5 | Xh1 |
| 6 | Yh1 |
| 7 | Rh1 |
| 8 | θh1 |
| 9 | Xh2 |
| 10 | Yh2 |
| 11 | Rh2 |
| 12 | θh2 |
| 13 | Noise |
| 14 | A1 |
| 15 | A2 |
| 16 | A3 |
| 17 | A4 |
| 18 | E1 |
| 19 | E2 |
| 20 | E3 |
| 21 | E4 |
| 返回的值是一个单一的字符串，该字符串 内不同值之间用逗号(,)分隔， 并且顺序是按照 发送指令时j, k, l, m, n的顺序。例如，发 送SNAPD? 1,1,2,5,4会返回通道A的X、Y、 Frequency和θ的值。这些值均放在同一个字 符串中，例如： "0.951359,0.0253297,1000.00,1.234"。 第一个是X值，第二个是Y值，第三个是频率 值，第四个是θ的值。 该指令仅用作同时查询几个不同的参数。 |  |
| OAUXD?指令用于读取后面板AUXIN接口的 输入电压值。参数i用于指定AUXIN1~4，i=1 时指定为AUXIN1的读取， i=4 时指定为AUXIN4 的读取。返回值以伏特(V)为单位。该指令仅用 作查询。 |  |
| SPTSD ?指令用于查询存储在数据缓存区 的点的数量。参数i用于指定通道A/B，i=1 |  |


<!-- image -->


<!-- Page 80 -->

74

OE1022D DSP Lock-In Amplifier

|  | 时指定为通道A的读取，i=2时指定为通道B 的读取。该指令可在任何时候发送。如果Data buffer被重置，就会返回0值。 该指令仅用作查询。 |
|---|---|
| TRCAD ? i,j,k,l | TRCAD ? i,j,k,l指令用于查询存储在 Buffer j数据缓存区的数据Buffer1~Buffer4。 返回值是ASCII浮点数的形式。不同点数 之间用逗号(,)分隔开， 并且最后一个点会伴随 着终结符。例如，两个点的返回值可能是 "-1.234567e-009,+7.654321e-009,"。 参数i,j, k, l都需要伴随着TRCAD?指令 发送。参数i用于指定通道A/B，i=1时指定为 通道A的读取，i=2时指定为通道B的读取。 参数 j 用于选择需要读取的数据缓存区 （j=1,2，3,4） ；读取的数据是从数据缓存区中 的第k (k≥0)个数据开始的；读取的总长度是 l (l≥1)。当读取单个数据时，设置l=1。 k+l的值不能超过数据缓存区Buffer里面 |
| INOVD ？ i | 存储的最大值16384。 INOVD ？指令用于查询当前输入信号是否 过大，从而导致前级过载。参数i用于指定通 道A/B，i=1时指定为通道A的读取，i=2时指 定为通道B的读取。正常返回0值，当输入信 号过大，前级过载时返回1。 该指令仅用作查询。 |
| GNOVD ？ i | GNOVD ？指令用于查询当前输入信号下， 所选的灵敏度以及动态储备过小，从而导致前 级增益过载。参数i用于指定通道A/B，i=1 时指定为通道A的读取，i=2时指定为通道B 的读取。正常返回0值，当所选灵敏度以及动 态储备过小的时候，会导致前级增益过大，从 而过载，此时返回值为1。 该指令仅用作查询。 |
| *PLLD ？ i | *PLLD ？指令用于查询当前频率下，内部 锁相环是否锁定在待测参考。参数i用于指定 通道A/B，i=1时指定为通道A的读取，i=2时 指定为通道B的读取。内部参考时，默认返回 值为0；外部参考时，锁相环的频率跟随外部 参考的频率变化而变化，锁相环锁定在外部参 考频率时返回1，其他情况返回0。 该指令仅用作查询。该指令仅用作查询。 |


<!-- image -->


<!-- Page 81 -->

OE1022D DSP Lock-In Amplifier

75
