## 8.4 串口通讯

本实例将演示 OE1022D 远程控制串口环境搭建以及调试操作， 你需要准备一条 USB 线， 步骤如下：


<!-- image -->

该串口调试软件包含了通讯设置，接收区设置，发送区设置，接收区，以及发送区。 OE1022D 默认波特率为 921600 ，校验位无，数据位 8 位，停止位 1 位（ OE1022D

的波 特率及校验位等可通过前面板键盘上的 RS232 菜单选项来设置） 。

串口号需要选择电脑为 OE1022D USB 接口自动分配的 COM 口， COM 端口编号可通过设 备管理器中的端口（ COM 和 LPT ）选项来查看（计算机右键 -> 属性 -> 设备管理器 -> 端口） ，如


<!-- image -->


<!-- Page 146 -->

140

OE1022D DSP Lock-In Amplifier

图 106 所示：


<!-- image -->


*图 106. 端口号的查看*


<!-- image -->

当配置好了端口号、波特率、校验位、数据位、停止位之后，如果连接按钮左边小圆圈 为黑色熄灭状态（ ） ，需要点击一次改变按钮状态显示为红色点亮状态 连接

（

） ，如果按钮为红色点亮状态就表明电脑跟当前串口号设备已连接成功，


<!-- image -->

若多次点击连接不成功，请检查端口号是否选择合适，然后再尝试连接。连接成功如图 107 所示：


<!-- image -->


<!-- Page 147 -->

OE1022D DSP Lock-In Amplifier

141


<!-- image -->

OE1022D

大写字母助记符后 + 通道选择 1/2 + 选项参数

例如指令 'SENSD,1,24+ 回车符（ 0D ） ' 或 'SENSD?,1+ 回车符（ 0D ） ' ，连续多条的指令可 以用 ' ； ' 号分隔开，指令结尾一定要附加上回车符或十六进制数 0D ，更多详细指令请查看 远程编程章节的介绍。

需要特别注意的是指令结尾一定要附加上回车符或十六进制数 0D 才会有效执行当前指 令。发送指令时首先在发送区键入指令，然后紧接着敲一下回车，最后点击发送按钮，指令 就会发送出去。如图 108 、图 109 所示：


<!-- image -->


<!-- Page 148 -->

142

OE1022D DSP Lock-In Amplifier


<!-- image -->


*图 108. ASCII 码形式发送和接收指令*


<!-- image -->


<!-- Page 149 -->

OE1022D DSP Lock-In Amplifier

143


<!-- image -->

同时的，串口调试助手可配置自动添加发送回车符 0X0D 。勾选发送区设置的 ' 自动发送 附加位 ' 选项 , 在弹出的附加位设置窗口选择固定位，附加值设置为十六进制值 '0D' 即可。配 置如图 110 所示：


<!-- image -->


<!-- Page 150 -->

144

OE1022D DSP Lock-In Amplifier


<!-- image -->

多个指令的发送需要添加 ';' 号来分隔开，例如发送指令 'SENSD 1,25;FMODD 1,1;FREQD ,1,2048;SENSD?,1;FMODD?,1;FREQD?,1' 效果如图 111 所示：


<!-- image -->


<!-- Page 151 -->

OE1022D DSP Lock-In Amplifier

145


<!-- image -->

连续读取 OE1022D 的 X 、 Y 、 R 、 θ 和 Freq 值，可以设置串口调试助手软件的间隔发送， 配置如图 112 、图 113 所示：


<!-- image -->


<!-- Page 152 -->

146

OE1022D DSP Lock-In Amplifier


<!-- image -->


*图 112. 连续读取单个 R 值*


<!-- image -->


<!-- Page 153 -->

OE1022D DSP Lock-In Amplifier

147


<!-- image -->

通过串口调试助手远程控制发送指令设置 OE1022D 内部参数时，会同时更新 LCD 显示 屏上状态的显示。例如 OE1022D 当前状态栏的 <sens> 值为 <100 mV> ，对应指令标识号为 25 。 当发送了指令 'SENS 24' 之后， OE1022D 状态栏 <sens> 值会改变为指令标识码 24 所对应的值 为 <50 mV> 。

OE1022D 不只是单一兼容以上这款串口调试助手（精装版 V3.8.3 ）的远程控制，现在网 络上许多的串口调试工具都能很好的兼容，操作步骤也基本类似。


<!-- image -->
